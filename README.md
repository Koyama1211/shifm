# Shifm - 個人バイトシフト管理ツール

ブラウザだけで動く、個人用のシフト管理アプリです。

## 主な機能

- 月間カレンダー表示
- 日別シフト登録 (1日複数件 / 勤務先 / 開始終了 / 休憩 / 時給 / 交通費 / メモ)
- 勤務先マスタ保存 (勤務先名 + 既定時給 + 既定交通費)
- 勤務先ごとのライン・シフトパターン管理 (選択で開始/終了/休憩を自動入力)
- 勤務先ごとの給与ルール保存 (残業開始時間 / 残業倍率 / 控除率)
- マスタ選択でシフト入力へ自動反映 (再入力を削減)
- 給与自動計算 (残業倍率・控除率対応)
- 月次サマリー表示 (勤務日数 / 総労働時間 / 支給見込み / 手取り見込み)
- 勤務先フィルタ付き月次サマリー + 勤務先別内訳
- 月次CSV出力
- Google Calendar 登録 (選択シフト or 当日分を登録画面に自動入力)
- PC/スマホ同期 (GitHub Gist 利用 / 上書き取得・差分マージ取得)
- 自動同期オプション (保存時自動同期 / 起動時差分マージ取得)
- GitHub設定なしのかんたん移行 (バックアップ書き出し/読み込み)
- PWA対応 (ホーム画面追加・オフライン時の基本表示)
- タブ型UIで機能分離 (`シフト` / `月次サマリー` / `設定` / `同期`)
- 段階的開示 (低頻度機能を `詳細操作` / `詳細設定` に格納)
- 状態保持 (`最終タブ` / `選択月` / `選択日` / `よく使う勤務先マスタ` を保持)
- 複数ユースケース対応 (`日次手入力` / `定型シフト週次一括登録` / `月次閲覧中心` / `同期運用`)
- マルチワーク前提の計算モデル (シフトごとに勤務先ポリシーを適用)

## 使い方

1. `index.html` をブラウザで開く。
2. 上部タブで `設定` を開き、`勤務先マスタ管理（低頻度）` を開いてよく使う勤務先の時給/交通費を保存する。
3. 上部タブで `シフト` を開き、カレンダーで日付を選択してシフトを保存する。必要なら同日に複数件登録する。
4. シフト画面で `勤務先マスタ` を選ぶと、勤務先・時給・交通費を自動反映できる。
5. 同じ勤務先でラインと時間帯が決まっている場合は、`設定` タブの `勤務先マスタ管理（低頻度）` → `ライン・シフトパターン設定` で先に登録する。
6. シフト入力時に `ライン` と `シフトパターン` を選ぶと、開始/終了/休憩が自動入力される。
7. その場で `勤務先マスタに保存` を押して新規マスタ登録もできる。
8. `設定` タブの `給与設定` で残業開始時間・残業倍率・控除率を設定する。
9. 勤務先ごとのルールが必要な場合は `勤務先マスタ管理（低頻度）` で勤務先別の残業/控除ルールを設定する。
10. `月次サマリー` タブで勤務先フィルタを使って月次集計を確認し、勤務先別内訳も確認する。必要ならCSV出力する。
11. Googleカレンダー登録やマスタ保存など低頻度操作は、`シフト` タブの `詳細操作（連携・補助）` から実行する。
12. 毎週同じ勤務が多い場合は、`シフト` タブの `定型シフト一括登録（週次）` で曜日・期間を指定して一括作成する。

## PC/スマホ同期の設定

このアプリは GitHub Gist を保存先に使って同期できます。

1. GitHub で非公開 Gist を1つ作成する。
2. Personal Access Token を作成する。
3. アプリの `同期` タブで `同期詳細設定（Token/Gist/差分マージ）` を開き、以下を入力する。
   - Token
   - Gist ID
   - ファイル名 (例: `shifm-data.json`)
4. `クラウドへ保存` でアップロード。
5. 別端末でも同じ設定を入力し `クラウドから取得` を押す。
6. 既存データを残したいときは `同期詳細設定` 内の `差分マージ取得` を使う。

必要であれば `保存時に自動同期する` を有効化できます。
さらに手動取得を減らしたい場合は `起動時に差分マージ取得する` を有効化してください。

## GitHubなしで端末移行する方法

1. 元の端末で `同期` タブを開く。
2. `バックアップ書き出し` を押して JSON ファイルを保存する。
3. そのファイルを AirDrop / LINE / iCloud Drive などで移す。
4. 移行先端末で同じアプリを開き、`バックアップ読み込み` でその JSON を選ぶ。

## スマホで使うとき

1. Web公開後にスマホでURLを開く。
2. ブラウザのメニューからホーム画面に追加する。
3. 初回だけ同期設定を入れ、`クラウドから取得` を実行する。

## 注意点

- Token は端末の `localStorage` に保存されます。個人利用専用で使ってください。
- Google Calendar は登録画面を開く方式です (ワンクリックで編集確定可能)。
- Service Worker (PWA) は `https` か `localhost` で有効になります。
- `今日` ボタンで当月・当日に即ジャンプできます。
